# =========================================================
# CONFIGURACIÓN GENERAL
# =========================================================
serenity {
  project.name = "Pragma Mobile Automation"
  logging = "VERBOSE"
  take.screenshots = "AFTER_EACH_STEP"
}

# =========================================================
# GESTIÓN DE ENTORNOS
# =========================================================
environments {

  # -----------------------------------------------------
  # 1. LOCAL: APP (APK SWAG LABS)
  # Se activa desde el Runner con: environment = local_app
  # -----------------------------------------------------
  local_app {
    webdriver {
      driver = appium
      remote.url = "http://127.0.0.1:4723/"
    }
    webdriver.capabilities {
      platformName = "Android"
      browserName = "" # Sin navegador porque es nativa
      "appium:automationName" = "UiAutomator2"
      "appium:deviceName" = "emulator-5554"

      # Ruta de tu APK (Carpeta 'apps' en minúscula)
      "appium:app" = "src/test/resources/apps/mda-2.2.0-25.apk"

      # Datos de Swag Labs
      "appium:appPackage" = "com.saucelabs.mydemoapp.android"
      "appium:appActivity" = "com.saucelabs.mydemoapp.android.view.activities.SplashActivity"

      "appium:fullReset" = false
      "appium:noReset" = false
      "appium:autoGrantPermissions" = true
      "appium:newCommandTimeout" = 800
    }
  }

  # -----------------------------------------------------
  # 2. LOCAL: WEB (CHROME CON DRIVER MANUAL)
  # Se activa desde el Runner con: environment = local_web
  # -----------------------------------------------------
  local_web {
    webdriver {
      # Usa tu clase MyAndroidDriver con el chromedriver.exe v133
      driver = provided
      provided {
        type = mydriver
        mydriver = co.com.pragma.utils.MyAndroidDriver
      }
      timeouts {
        implicitlywait = 2000
        fluentwait = 5000
      }
    }
  }

  # -----------------------------------------------------
  # 3. BROWSERSTACK: WEB
  # Se activa desde el Runner con: environment = android_web
  # -----------------------------------------------------
  android_web {
    webdriver {
      driver = remote
      remote.url = "https://hub-cloud.browserstack.com/wd/hub"
    }
    capabilities {
      browserName = "Chrome"
      "bstack:options" {
        osVersion = "13.0"
        deviceName = "Samsung Galaxy S23"
        local = "false"
        projectName = "Pragma Web Test"
      }
    }
  }

  # -----------------------------------------------------
  # 4. BROWSERSTACK: APP
  # Se activa desde el Runner con: environment = android_app
  # -----------------------------------------------------
  android_app {
    webdriver {
      driver = remote
      remote.url = "https://hub-cloud.browserstack.com/wd/hub"
    }
    capabilities {
      "bstack:options" {
        osVersion = "12.0"
        deviceName = "Google Pixel 6 Pro"
        projectName = "Pragma App Test"
      }
      # Aquí dejé la configuración de Play Store que tenías antes
      # Si quieres probar Swag Labs en BrowserStack, deberías subir la APK allá
      "appium:appPackage" = "com.android.vending"
      "appium:appActivity" = "com.google.android.finsky.activities.MainActivity"
      "appium:automationName" = "UIAutomator2"
      autoGrantPermissions = true
    }
  }
}