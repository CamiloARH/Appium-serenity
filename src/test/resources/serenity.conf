# --- CONFIGURACIÓN GLOBAL ---
webdriver {
  timeouts {
    implicitlywait = 5000
    fluentwait = 10000
  }
}

serenity {
  project.name = "Pragma Mobile Automation"
  logging = VERBOSE
  take.screenshots = AFTER_EACH_STEP
}

# --- GESTIÓN DE ENTORNOS ---
environments {

  # 1. BROWSERSTACK: Web (Serebii)
  android_web {
    webdriver {
      driver = remote
      remote.url = "https://hub-cloud.browserstack.com/wd/hub"
    }
    capabilities {
      "bstack:options" {
        osVersion = "13.0"
        deviceName = "Samsung Galaxy S23"
        local = "false"
        projectName = "Pragma Web Test"
      }
      browserName = "chrome"
    }
  }

  # 2. BROWSERSTACK: App (Play Store)
  android_app {
    webdriver {
      driver = remote
      remote.url = "https://hub-cloud.browserstack.com/wd/hub"
    }
    capabilities {
      "bstack:options" {
        osVersion = "12.0"
        deviceName = "Google Pixel 6 Pro"
        projectName = "Pragma App Test"
      }
      appPackage = "com.android.vending"
      appActivity = "com.google.android.finsky.activities.MainActivity"
      autoGrantPermissions = true
      automationName = "UIAutomator2"
    }
  }

  # 3. LOCAL: Web (Serebii)
  local_web {
    webdriver {
      driver = appium
      base.url = "https://www.serebii.net"
    }

    capabilities {
      platformName = "Android"
      automationName = "UIAutomator2"
      browserName = "Chrome"
      deviceName = "emulator-5554" # Change this to your device name
      nativeWebScreenshot = true
      newCommandTimeout = 800
    }
  }

# 4. LOCAL: App (Play Store)
  local_app {
    webdriver {
      driver = appium
    }

    # AJUSTE CLAVE: Definir platformName aquí explícitamente para Serenity
    appium {
      platformName = "Android"
      hub = "http://127.0.0.1:4723/"
    }

    capabilities {
      # platformName = "Android"  <-- Ya no es necesario aquí si está arriba, pero no estorba
      "appium:automationName" = "UIAutomator2"
      "appium:deviceName" = "emulator-5554"
      "appium:appPackage" = "com.android.vending"
      "appium:appActivity" = "com.google.android.finsky.activities.MainActivity"
      "appium:noReset" = true
      "appium:fullReset" = false
    }
  }
}