# --- CONFIGURACIÓN GLOBAL (VALORES POR DEFECTO) ---
# Si no especificas un ambiente, se usará esta configuración (Local Web Android)
webdriver {
  driver = appium
  timeouts {
    implicitlywait = 5000
    fluentwait = 10000
  }
}

# Configuración por defecto para Appium (Local Web)
appium {
  hub = "http://127.0.0.1:4723"
  platformName = "Android"
  automationName = "UiAutomator2"
  deviceName = "emulator-5554"
  browserName = "Chrome"

  # Esta línea es vital para tu error de versión
  chromedriverAutodownload = true

  nativeWebScreenshot = true
  newCommandTimeout = 800
}

serenity {
  project.name = "Pragma Mobile Automation"
  logging = "VERBOSE"
  take.screenshots = "AFTER_EACH_STEP"
}

# --- GESTIÓN DE ENTORNOS ESPECÍFICOS ---
environments {

  # 1. BROWSERSTACK: Web (Serebii)
  android_web {
    webdriver {
      driver = remote
      remote.url = "https://hub-cloud.browserstack.com/wd/hub"
    }
    capabilities {
      "bstack:options" {
        osVersion = "13.0"
        deviceName = "Samsung Galaxy S23"
        local = "false"
        projectName = "Pragma Web Test"
      }
      browserName = "Chrome"
    }
  }

  # 2. BROWSERSTACK: App (Play Store)
  android_app {
    webdriver {
      driver = remote
      remote.url = "https://hub-cloud.browserstack.com/wd/hub"
    }
    capabilities {
      "bstack:options" {
        osVersion = "12.0"
        deviceName = "Google Pixel 6 Pro"
        projectName = "Pragma App Test"
      }
      "appium:appPackage" = "com.android.vending"
      "appium:appActivity" = "com.google.android.finsky.activities.MainActivity"
      "appium:automationName" = "UIAutomator2"
      autoGrantPermissions = true
    }
  }

  # 3. LOCAL: Web (Serebii) - (Redundante con el default, pero bueno tenerlo explícito)
  local_web {
      webdriver {
        driver = appium
        remote.url = "http://127.0.0.1:4723"
      }
      capabilities {
        platformName = "Android"
        "appium:options" {
          automationName = "UiAutomator2"
          browserName = "Chrome"
          deviceName = "emulator-5554"
          nativeWebScreenshot = true
          newCommandTimeout = 800
          chromedriverAutodownload = true
        }
      }
  }

  # 4. LOCAL: App (Play Store)
  local_app {
    webdriver {
      driver = appium
      remote.url = "http://127.0.0.1:4723"
    }

    capabilities {
      platformName = "Android"
      "appium:options" {
        automationName = "UiAutomator2"
        deviceName = "emulator-5554"
        appPackage = "com.android.vending"
        appActivity = "com.google.android.finsky.activities.MainActivity"
        noReset = true
        autoGrantPermissions = true
      }
    }
  }
}